schema_version: arch-map.v1
meta:
  generated_at: '2026-01-10T20:35:39.679770+00:00'
  generator: update_architecture_docs.py
  generator_version: 2.0.0
  source_commit: current_development
  freshness_days: 7
  notes:
  - Single source of truth for actifix architecture contexts
  - Keep aligned with quality gates and architecture compliance
  - Auto-generated - includes persistence and testing subsystems
domains:
- id: runtime
  summary: Bootstrap, configuration, state management, lifecycle
- id: infra
  summary: Logging, health monitoring, persistence, observability
- id: core
  summary: Error handling, ticket management, automated remediation
- id: tooling
  summary: Testing, quality assurance, architecture validation
modules:
- id: bootstrap.main
  domain: runtime
  owner: runtime
  summary: Main entrypoint orchestrating system initialization and process management
  entrypoints:
  - src/actifix/main.py
  - src/actifix/bootstrap.py
  contracts:
  - ensures environment setup
  - launches core services in correct order
  depends_on:
  - runtime.config
  - infra.logging
  - infra.health
- id: runtime.api
  domain: runtime
  owner: runtime
  summary: Public API surface and package exports
  entrypoints:
  - src/actifix/__init__.py
  - src/actifix/api.py
  contracts:
  - expose stable API
  - centralize package exports
  depends_on:
  - core.raise_af
  - bootstrap.main
  - runtime.state
  - infra.health
- id: runtime.config
  domain: runtime
  owner: runtime
  summary: Configuration management and environment normalization
  entrypoints:
  - src/actifix/config.py
  contracts:
  - centralize configuration
  - validate environment state
  - fail fast on invalid config
  depends_on:
  - infra.logging
- id: runtime.state
  domain: runtime
  owner: runtime
  summary: State management and persistence paths
  entrypoints:
  - src/actifix/state_paths.py
  contracts:
  - atomic state operations
  - recoverable state management
  depends_on:
  - infra.logging
- id: runtime.dock_icon
  domain: runtime
  owner: runtime
  summary: macOS dock icon helper utilities
  entrypoints:
  - src/actifix/dock_icon.py
  contracts:
  - safe no-op on non-macOS
  - avoid side effects on import
  depends_on: []
- id: infra.logging
  domain: infra
  owner: infra
  summary: Centralized logging system with correlation tracking
  entrypoints:
  - src/actifix/log_utils.py
  contracts:
  - single logging sink
  - structured error logging
  - correlation IDs
  depends_on: []
- id: infra.health
  domain: infra
  owner: infra
  summary: Health monitoring and system status tracking
  entrypoints:
  - src/actifix/health.py
  contracts:
  - detect degraded states
  - surface system health
  - continuous monitoring
  depends_on:
  - infra.logging
- id: infra.persistence.atomic
  domain: infra
  owner: persistence
  summary: Atomic file operations for durability and safety
  entrypoints:
  - src/actifix/persistence/atomic.py
  contracts:
  - atomic writes
  - append with size limits
  - idempotent operations
  depends_on:
  - infra.logging
- id: infra.persistence.api
  domain: infra
  owner: persistence
  summary: Persistence package public API and exports
  entrypoints:
  - src/actifix/persistence/__init__.py
  contracts:
  - re-export persistence interfaces
  - keep API stable
  depends_on:
  - infra.persistence.atomic
  - infra.persistence.storage
  - infra.persistence.queue
  - infra.persistence.manager
  - infra.persistence.health
  - infra.persistence.paths
- id: infra.persistence.storage
  domain: infra
  owner: persistence
  summary: Storage backend abstraction (file, memory, JSON)
  entrypoints:
  - src/actifix/persistence/storage.py
  contracts:
  - pluggable storage backends
  - consistent interface
  - error handling
  depends_on:
  - infra.logging
  - infra.persistence.atomic
- id: infra.persistence.queue
  domain: infra
  owner: persistence
  summary: Persistence queue for asynchronous operations
  entrypoints:
  - src/actifix/persistence/queue.py
  contracts:
  - durable operation queue
  - replay capability
  - entry pruning
  depends_on:
  - infra.logging
  - infra.persistence.storage
- id: infra.persistence.manager
  domain: infra
  owner: persistence
  summary: High-level persistence management with transactions
  entrypoints:
  - src/actifix/persistence/manager.py
  contracts:
  - transactional operations
  - document management
  - queue integration
  depends_on:
  - infra.logging
  - infra.persistence.storage
  - infra.persistence.queue
- id: infra.persistence.health
  domain: infra
  owner: persistence
  summary: Storage health checks and corruption detection
  entrypoints:
  - src/actifix/persistence/health.py
  contracts:
  - storage validation
  - integrity verification
  - corruption detection
  depends_on:
  - infra.logging
  - infra.persistence.storage
- id: infra.persistence.paths
  domain: infra
  owner: persistence
  summary: Storage path configuration and management
  entrypoints:
  - src/actifix/persistence/paths.py
  contracts:
  - centralized path configuration
  - directory helpers
  depends_on:
  - infra.logging
- id: infra.persistence.database
  domain: infra
  owner: persistence
  summary: SQLite database backend with connection pooling and schema management
  entrypoints:
  - src/actifix/persistence/database.py
  contracts:
  - thread-safe connection pooling
  - automatic schema migrations
  - WAL mode for concurrency
  depends_on:
  - infra.logging
- id: infra.persistence.ticket_repo
  domain: infra
  owner: persistence
  summary: Ticket repository with CRUD operations and locking
  entrypoints:
  - src/actifix/persistence/ticket_repo.py
  contracts:
  - database CRUD for tickets
  - lease-based locking
  - duplicate prevention
  depends_on:
  - infra.logging
  - infra.persistence.database
  - core.raise_af
- id: core.raise_af
  domain: core
  owner: core
  summary: Error capture and ticket creation system
  entrypoints:
  - src/actifix/raise_af.py
  contracts:
  - capture all errors
  - create structured tickets
  - prevent duplication
  depends_on:
  - infra.logging
  - core.quarantine
- id: core.do_af
  domain: core
  owner: core
  summary: Ticket processing and automated remediation
  entrypoints:
  - src/actifix/do_af.py
  contracts:
  - process tickets systematically
  - integrate with AI systems
  - validate fixes
  depends_on:
  - infra.logging
  - core.raise_af
  - core.ai_client
- id: core.quarantine
  domain: core
  owner: core
  summary: Error isolation and safe failure handling
  entrypoints:
  - src/actifix/quarantine.py
  contracts:
  - isolate corrupted state
  - prevent system-wide failures
  depends_on:
  - infra.logging
  - runtime.state
- id: tooling.testing.system
  domain: tooling
  owner: testing
  summary: System-level test framework and test builder
  entrypoints:
  - src/actifix/testing/system.py
  contracts:
  - build system tests
  - validate dependencies
  - enforce architecture
  depends_on:
  - infra.logging
  - runtime.state
- id: tooling.testing.reporting
  domain: tooling
  owner: testing
  summary: Test cycle reporting and progress tracking
  entrypoints:
  - src/actifix/testing/reporting.py
  contracts:
  - test inventory
  - numbered progress
  - cycle logs
  depends_on:
  - infra.logging
  - tooling.testing.system
- id: tooling.testing
  domain: tooling
  owner: tooling
  summary: Quality assurance and testing framework
  entrypoints:
  - src/actifix/testing/__init__.py
  - test.py
  contracts:
  - enforce quality gates
  - maintain test coverage
  - validate architecture
  depends_on:
  - bootstrap.main
  - infra.logging
  - tooling.testing.system
  - tooling.testing.reporting
- id: tooling.simple_ticket_attack
  domain: tooling
  owner: tooling
  summary: Batch creation of lightweight tickets through the Actifix pipeline
  entrypoints:
  - src/actifix/simple_ticket_attack.py
  contracts:
  - generate sequences of simple tickets with record_error
  - keep ACTIFIX-LIST.md untouched by manual edits
  - reuse the core ticketing flow for experiments
  depends_on:
  - core.raise_af
  - runtime.state
- id: tooling.migrate_to_db
  domain: tooling
  owner: tooling
  summary: Migration script to import tickets from ACTIFIX-LIST.md to database
  entrypoints:
  - src/actifix/migrate_to_db.py
  contracts:
  - parse markdown ticket format
  - import to SQLite database
  - preserve all ticket data
  depends_on:
  - core.raise_af
  - infra.persistence.ticket_repo
  - runtime.state

- id: core.ai_client
  domain: core
  owner: core
  summary: Multi-provider AI integration with automatic fallback chain
  entrypoints:
  - src/actifix/ai_client.py
  contracts:
  - Claude Code local auth detection
  - Claude API integration
  - OpenAI GPT-4 Turbo integration
  - Ollama local model support
  - Free alternative user prompts
  - Automatic provider fallback
  - Cost tracking and logging
  depends_on:
  - runtime.config
  - infra.logging
  - runtime.state
contracts:
- id: contract.logging
  summary: All modules must log via centralized logging system with correlation IDs
  applies_to:
  - bootstrap.main
  - runtime.config
  - core.raise_af
  - core.do_af
  - infra.health
  - infra.persistence.atomic
  - infra.persistence.storage
  - infra.persistence.queue
  - infra.persistence.manager
  - tooling.testing
  enforced_by:
  - infra.logging
- id: contract.error_isolation
  summary: Error handling must isolate failures and prevent system-wide corruption
  applies_to:
  - core.raise_af
  - core.do_af
  enforced_by:
  - core.quarantine
- id: contract.quality_gates
  summary: All components must pass quality gates and maintain architecture compliance
  applies_to:
  - bootstrap.main
  - runtime.config
  - runtime.state
  - core.raise_af
  - core.do_af
  - infra.persistence.manager
  enforced_by:
  - tooling.testing
  - infra.health
- id: contract.durability
  summary: All persistence operations must be atomic and recoverable
  applies_to:
  - infra.persistence.atomic
  - infra.persistence.storage
  - infra.persistence.queue
  - infra.persistence.manager
  enforced_by:
  - infra.persistence.atomic
  - infra.persistence.health
